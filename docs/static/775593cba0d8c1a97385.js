(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{159:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},160:function(e,t,n){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return o}))},161:function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return r}))},162:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(14),n(23);var r=n(3),o=n(159),c=n(160),f=function(){function e(t,n,r){Object(o.a)(this,e),this.dbName=t,this.storeName=n,this.keyName=r}var t,n,f;return Object(c.a)(e,[{key:"getTransaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite";return this.db.transaction(e,t)}},{key:"getStore",value:function(){return this.getTransaction([this.storeName]).objectStore(this.storeName)}},{key:"add",value:function(data){this.getStore().add(data).onsuccess=function(){console.log("save success.")}}},{key:"remove",value:function(e){console.log(e),this.getStore().delete(e).onsuccess=function(){console.log("delete success.")}}},{key:"update",value:function(e,data){data[this.keyName]=e,this.getStore().put(data).onsuccess=function(){console.log("update success.")}}},{key:"get",value:(f=Object(r.a)(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=n.getStore().get(t);o.onsuccess=function(){var t=o.result;e(t)},o.onerror=r})));case 1:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"getCount",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.getStore().count();r.onsuccess=function(){e(r.result)}})));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"getAll",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=[];t.getStore().openCursor().onsuccess=function(t){var cursor=t.target.result;if(cursor){var n=cursor.value;r.push(n),cursor.continue()}e(r)}})));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}],[{key:"DB_NAME",get:function(){return this.dbName}},{key:"STORE_NAME",get:function(){return this.storeName}}]),e}()},163:function(e,t,n){"use strict";var r=n(25);function o(e,t){return!t||"object"!==Object(r.a)(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}n.d(t,"a",(function(){return o}))},164:function(e,t,n){"use strict";function r(e,p){return(r=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}n.d(t,"a",(function(){return o}))},165:function(e,t,n){"use strict";n(14),n(23);var r=n(3),o=n(159),c=n(160),f=n(163),l=n(161),d=n(164),v=function(e){function t(){return Object(o.a)(this,t),Object(f.a)(this,Object(l.a)(t).call(this,"PriceDB","price","idx_key"))}var n,v,h;return Object(d.a)(t,e),Object(c.a)(t,[{key:"connect",value:(h=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t.db)e(t);else{var r=indexedDB.open(t.dbName);r.onupgradeneeded=function(e){var n=e.target.result.createObjectStore(t.storeName,{keyPath:t.keyName});n.createIndex("item_id","item_id",{unique:!1}),n.createIndex("shop_id","shop_id",{unique:!1})},r.onsuccess=function(n){t.db=n.target.result,e(t)}}})));case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"genIdxKey",value:function(e,t){return e+";"+t}},{key:"save",value:function(e,t,n){var data={idx_key:this.genIdxKey(e,t),item_id:e,shop_id:t,price:n,updated:Math.floor((new Date).getTime()/1e3)};this.getStore().put(data).onsuccess=function(){console.log("price save success.")}}},{key:"getByItemId",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=[],c=n.getStore(),f=IDBKeyRange.only(t),l=c.index("item_id").openCursor(f,"next");l.onsuccess=function(){var cursor=l.result;if(cursor){var t=cursor.value;o.push(t),cursor.continue()}e(o)}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"getByShopId",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=[],c=n.getStore(),f=IDBKeyRange.only(t),l=c.index("shop_id").openCursor(f,"next");l.onsuccess=function(){var cursor=l.result;if(cursor){var t=cursor.value;o.push(t),cursor.continue()}e(o)}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),t}(n(162).a);t.a=new v},166:function(e,t,n){"use strict";n(14),n(23);var r=n(3),o=n(159),c=n(160),f=n(163),l=n(161),d=n(164),v=function(e){function t(){return Object(o.a)(this,t),Object(f.a)(this,Object(l.a)(t).call(this,"ShopDB","shop","shop_id"))}var n,v;return Object(d.a)(t,e),Object(c.a)(t,[{key:"connect",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t.db)e(t);else{var r=indexedDB.open(t.dbName);r.onupgradeneeded=function(e){e.target.result.createObjectStore(t.storeName,{keyPath:t.keyName,autoIncrement:!0})},r.onsuccess=function(n){t.db=n.target.result,e(t)}}})));case 1:case"end":return e.stop()}}),e)}))),function(){return v.apply(this,arguments)})},{key:"getLatestShop",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=null,o=t.getStore(),c=IDBKeyRange.lowerBound(0,!0);o.openCursor(c,"prev").onsuccess=function(t){var cursor=t.target.result;cursor&&(r=cursor.value),e(r)}})));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}]),t}(n(162).a);t.a=new v},167:function(e,t,n){"use strict";n(14),n(23);var r=n(3),o=n(159),c=n(160),f=n(163),l=n(161),d=n(164),v=function(e){function t(){return Object(o.a)(this,t),Object(f.a)(this,Object(l.a)(t).call(this,"ItemDB","item","item_id"))}var n,v,h;return Object(d.a)(t,e),Object(c.a)(t,[{key:"connect",value:(h=Object(r.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){if(t.db)e(t);else{var r=indexedDB.open(t.dbName);r.onupgradeneeded=function(e){e.target.result.createObjectStore(t.storeName,{keyPath:t.keyName,autoIncrement:!0}).createIndex("parent_id","parent_id",{unique:!1})},r.onsuccess=function(n){t.db=n.target.result,e(t)}}})));case 1:case"end":return e.stop()}}),e)}))),function(){return h.apply(this,arguments)})},{key:"getChilds",value:(v=Object(r.a)(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=[],c=n.getStore(),f=IDBKeyRange.only(t),l=c.index("parent_id").openCursor(f,"next");l.onsuccess=function(){var cursor=l.result;if(cursor){var t=cursor.value;o.push(t),cursor.continue()}e(o)}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"getLatestItem",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=null,c=n.getStore(),f=IDBKeyRange.only(t),l=c.index("parent_id").openCursor(f,"prev");l.onsuccess=function(){var cursor=l.result;cursor&&(o=cursor.value),e(o)}})));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),t}(n(162).a);t.a=new v},172:function(e,t,n){"use strict";n.r(t);n(23);var r=n(3),o=n(165),c=n(167),f=n(166),l={asyncData:function(e){return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,l,d,v,h,i,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},r=parseInt(e.params.id),t.next=4,c.a.connect();case 4:return l=t.sent,t.next=7,l.get(r);case 7:return d=t.sent,t.next=10,f.a.connect();case 10:return v=t.sent,t.next=13,o.a.connect();case 13:return h=t.sent,t.next=16,h.getByItemId(r);case 16:n=t.sent,i=0;case 18:if(!(i<n.length)){t.next=28;break}return n[i].idx_key,n[i].updated=e.app.$ts2date(n[i].updated),t.next=23,v.get(n[i].shop_id);case 23:m=t.sent,n[i].shop_name=m.shop_name;case 25:i++,t.next=18;break;case 28:return t.abrupt("return",{item_name:d.item_name,prices:n});case 29:case"end":return t.stop()}}),t)})))()}},d=n(24),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"section"},[n("p",[n("nuxt-link",{attrs:{to:"/items/"}},[e._v("<<品目管理")])],1),e._v(" "),n("h2",[e._v(e._s(e.item_name)+" の登録単価")]),e._v(" "),n("hr"),e._v(" "),n("table",{staticClass:"table is-mobile",staticStyle:{width:"100%"}},[e._m(0),e._v(" "),e.prices.length>0?n("tbody",e._l(e.prices,(function(t){return n("tr",[n("td",[e._v(e._s(t.shop_name))]),e._v(" "),n("td",[e._v(e._s(t.price)+"円")]),e._v(" "),n("td",[e._v(e._s(t.updated))])])})),0):n("tbody",[e._m(1)])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("品目名")]),t("th",{staticStyle:{width:"6em"}},[this._v("単価")]),t("th",{staticStyle:{width:"10em"}},[this._v("登録日時")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",{attrs:{colspan:"3"}},[this._v("単価の登録はありません。")])])}],!1,null,null,null);t.default=component.exports}}]);